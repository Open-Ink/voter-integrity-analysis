
  create or replace   view DBT_VOTER_DATA.cleaned.alaska_ncoa_results
  
   as (
    SELECT '2023-09-01'::date           as INPUT_FILE_DATE,
       'AK'                         AS INPUT_STATE,
       ADD_INFO.COUNTY_NAME         AS INPUT_COUNTY,
       NCOA.INPUT_ASCENSION         AS INPUT_VOTER_ID,
       NCOA.INPUT_LAST_NAME         AS INPUT_LAST_NAME,
       NCOA.INPUT_FIRST_NAME        AS INPUT_FIRST_NAME,
       NCOA.INPUT_MIDDLE_NAME       AS INPUT_MIDDLE_NAME,
       NCOA.INPUT_SUFFIX_NAME       AS INPUT_SUFFIX,
       NCOA.INPUT_RESIDENCE_ADDRESS AS INPUT_ADDRESS_LINE_1,
       NULL                         AS INPUT_ADDRESS_LINE_2,
       NCOA.INPUT_RESIDENCE_CITY    AS INPUT_RESIDENCE_CITY,
       NCOA.INPUT_STATE             AS INPUT_RESIDENCE_STATE,
       NCOA.INPUT_RESIDENCE_ZIP     AS INPUT_RESIDENCE_ZIPCODE,
       NCOA.HOUSEHOLD_POSITION,
       NCOA.NAME_ID,
       NCOA.INDIVIDUAL_RECORD_ID,
       NCOA.FIRST_NAME,
       NCOA.LAST_NAME,
       NCOA.COMPANY_NAME,
       NCOA.STREET_NUMBER,
       NCOA.STREET_PRE_DIRECTION,
       NCOA.STREET_NAME,
       NCOA.STREET_POST_DIRECTION,
       NCOA.STREET_SUFFIX,
       NCOA.UNIT_TYPE,
       NCOA.UNIT_NUMBER,
       NCOA.BOX_NUMBER,
       NCOA.CITY_NAME,
       NCOA.STATE_CODE,
       NCOA.POSTAL_CODE,
       NCOA.POSTAL_CODE_EXTENSION,
       NCOA.CARRIER_ROUTE,
       NCOA.ADDRESS_STATUS,
       NCOA.ERROR_NUMBER,
       NCOA.ADDRESS_TYPE,
       NCOA.DELIVERY_POINT,
       NCOA.CHECK_DIGIT,
       NCOA.DELIVERY_POINT_VERIFICATION,
       NCOA.DELIVERY_POINT_VERIFICATION_NOTES,
       NCOA.VACANT,
       NCOA.CONGRESSIONAL_DISTRICT_CODE,
       NCOA.AREA_CODE,
       NCOA.LATITUDE,
       NCOA.LONGITUDE,
       NCOA.TIME_ZONE,
       NCOA.COUNTY_NAME,
       NCOA.COUNTY_FIPS,
       NCOA.STATE_FIPS,
       NCOA.BARCODE,
       NCOA.LOCATABLE_ADDRESS_CONVERSION_SYSTEM,
       NCOA.LINE_OF_TRAVEL,
       NCOA.ASCENDING_OR_DESCENDING,
       NCOA.MOVE_APPLIED,
       NCOA.MOVE_TYPE,
       NCOA.MOVE_DATE,
       NCOA.MOVE_DISTANCE,
       NCOA.MATCH_FLAG,
       NCOA.NXI,
       NCOA.ANK,
       NCOA.RESIDENTIAL_DELIVERY_INDICATOR,
       NCOA.RECORD_TYPE,
       NCOA.COUNTRY_CODE,
       NCOA.ADDRESS_LINE_1,
       NCOA.ADDRESS_LINE_2,
       NCOA.ADDRESS_ID,
       NCOA.HOUSEHOLD_ID,
       NCOA.INDIVIDUAL_ID
FROM RAW.ALASKA_NCOA_RESULTS_2023_11_13 NCOA
         INNER JOIN RAW.ALASKA_NCOA_RESULTS_2023_11_13 ADD_INFO
                    ON NCOA.INPUT_ASCENSION = ADD_INFO.INPUT_ASCENSION AND ADD_INFO.RECORD_TYPE IN ('A', 'H')
  );

