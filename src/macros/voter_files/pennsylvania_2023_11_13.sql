{% macro import_pennsylvania_voters() %}


create table IF NOT EXISTS RAW.PENNSYLVANIA_VOTERS_2023_11_13
(
    ID_NUMBER               VARCHAR,
    TITLE                   VARCHAR,
    LAST_NAME               VARCHAR,
    FIRST_NAME              VARCHAR,
    MIDDLE_NAME             VARCHAR,
    SUFFIX                  VARCHAR,
    GENDER                  VARCHAR,
    DOB                     VARCHAR,
    REGISTRATION_DATE       VARCHAR,
    VOTER_STATUS            VARCHAR,
    STATUS_CHANGE_DATE      VARCHAR,
    PARTY_CODE              VARCHAR,
    HOUSE_NUMBER            VARCHAR,
    HOUSE_NUMBER_SUFFIX     VARCHAR,
    STREET_NAME             VARCHAR,
    APARTMENT_NUMBER        VARCHAR,
    ADDRESS_LINE_2          VARCHAR,
    CITY                    VARCHAR,
    STATE                   VARCHAR,
    ZIP                     VARCHAR,
    MAIL_ADDRESS_1          VARCHAR,
    MAIL_ADDRESS_2          VARCHAR,
    MAIL_CITY               VARCHAR,
    MAIL_STATE              VARCHAR,
    MAIL_ZIP                VARCHAR,
    LAST_VOTE_DATE          VARCHAR,
    PRECINCT_CODE           VARCHAR,
    PRECINCT_SPLIT_ID       VARCHAR,
    DATE_LAST_CHANGED       VARCHAR,
    CUSTOM_DATA_1           VARCHAR,
    DISTRICT_1              VARCHAR,
    DISTRICT_2              VARCHAR,
    DISTRICT_3              VARCHAR,
    DISTRICT_4              VARCHAR,
    DISTRICT_5              VARCHAR,
    DISTRICT_6              VARCHAR,
    DISTRICT_7              VARCHAR,
    DISTRICT_8              VARCHAR,
    DISTRICT_9              VARCHAR,
    DISTRICT_10             VARCHAR,
    DISTRICT_11             VARCHAR,
    DISTRICT_12             VARCHAR,
    DISTRICT_13             VARCHAR,
    DISTRICT_14             VARCHAR,
    DISTRICT_15             VARCHAR,
    DISTRICT_16             VARCHAR,
    DISTRICT_17             VARCHAR,
    DISTRICT_18             VARCHAR,
    DISTRICT_19             VARCHAR,
    DISTRICT_20             VARCHAR,
    DISTRICT_21             VARCHAR,
    DISTRICT_22             VARCHAR,
    DISTRICT_23             VARCHAR,
    DISTRICT_24             VARCHAR,
    DISTRICT_25             VARCHAR,
    DISTRICT_26             VARCHAR,
    DISTRICT_27             VARCHAR,
    DISTRICT_28             VARCHAR,
    DISTRICT_29             VARCHAR,
    DISTRICT_30             VARCHAR,
    DISTRICT_31             VARCHAR,
    DISTRICT_32             VARCHAR,
    DISTRICT_33             VARCHAR,
    DISTRICT_34             VARCHAR,
    DISTRICT_35             VARCHAR,
    DISTRICT_36             VARCHAR,
    DISTRICT_37             VARCHAR,
    DISTRICT_38             VARCHAR,
    DISTRICT_39             VARCHAR,
    DISTRICT_40             VARCHAR,
    ELECTION_1_VOTE_METHOD  VARCHAR,
    ELECTION_1_PARTY        VARCHAR,
    ELECTION_2_VOTE_METHOD  VARCHAR,
    ELECTION_2_PARTY        VARCHAR,
    ELECTION_3_VOTE_METHOD  VARCHAR,
    ELECTION_3_PARTY        VARCHAR,
    ELECTION_4_VOTE_METHOD  VARCHAR,
    ELECTION_4_PARTY        VARCHAR,
    ELECTION_5_VOTE_METHOD  VARCHAR,
    ELECTION_5_PARTY        VARCHAR,
    ELECTION_6_VOTE_METHOD  VARCHAR,
    ELECTION_6_PARTY        VARCHAR,
    ELECTION_7_VOTE_METHOD  VARCHAR,
    ELECTION_7_PARTY        VARCHAR,
    ELECTION_8_VOTE_METHOD  VARCHAR,
    ELECTION_8_PARTY        VARCHAR,
    ELECTION_9_VOTE_METHOD  VARCHAR,
    ELECTION_9_PARTY        VARCHAR,
    ELECTION_10_VOTE_METHOD VARCHAR,
    ELECTION_10_PARTY       VARCHAR,
    ELECTION_11_VOTE_METHOD VARCHAR,
    ELECTION_11_PARTY       VARCHAR,
    ELECTION_12_VOTE_METHOD VARCHAR,
    ELECTION_12_PARTY       VARCHAR,
    ELECTION_13_VOTE_METHOD VARCHAR,
    ELECTION_13_PARTY       VARCHAR,
    ELECTION_14_VOTE_METHOD VARCHAR,
    ELECTION_14_PARTY       VARCHAR,
    ELECTION_15_VOTE_METHOD VARCHAR,
    ELECTION_15_PARTY       VARCHAR,
    ELECTION_16_VOTE_METHOD VARCHAR,
    ELECTION_16_PARTY       VARCHAR,
    ELECTION_17_VOTE_METHOD VARCHAR,
    ELECTION_17_PARTY       VARCHAR,
    ELECTION_18_VOTE_METHOD VARCHAR,
    ELECTION_18_PARTY       VARCHAR,
    ELECTION_19_VOTE_METHOD VARCHAR,
    ELECTION_19_PARTY       VARCHAR,
    ELECTION_20_VOTE_METHOD VARCHAR,
    ELECTION_20_PARTY       VARCHAR,
    ELECTION_21_VOTE_METHOD VARCHAR,
    ELECTION_21_PARTY       VARCHAR,
    ELECTION_22_VOTE_METHOD VARCHAR,
    ELECTION_22_PARTY       VARCHAR,
    ELECTION_23_VOTE_METHOD VARCHAR,
    ELECTION_23_PARTY       VARCHAR,
    ELECTION_24_VOTE_METHOD VARCHAR,
    ELECTION_24_PARTY       VARCHAR,
    ELECTION_25_VOTE_METHOD VARCHAR,
    ELECTION_25_PARTY       VARCHAR,
    ELECTION_26_VOTE_METHOD VARCHAR,
    ELECTION_26_PARTY       VARCHAR,
    ELECTION_27_VOTE_METHOD VARCHAR,
    ELECTION_27_PARTY       VARCHAR,
    ELECTION_28_VOTE_METHOD VARCHAR,
    ELECTION_28_PARTY       VARCHAR,
    ELECTION_29_VOTE_METHOD VARCHAR,
    ELECTION_29_PARTY       VARCHAR,
    ELECTION_30_VOTE_METHOD VARCHAR,
    ELECTION_30_PARTY       VARCHAR,
    ELECTION_31_VOTE_METHOD VARCHAR,
    ELECTION_31_PARTY       VARCHAR,
    ELECTION_32_VOTE_METHOD VARCHAR,
    ELECTION_32_PARTY       VARCHAR,
    ELECTION_33_VOTE_METHOD VARCHAR,
    ELECTION_33_PARTY       VARCHAR,
    ELECTION_34_VOTE_METHOD VARCHAR,
    ELECTION_34_PARTY       VARCHAR,
    ELECTION_35_VOTE_METHOD VARCHAR,
    ELECTION_35_PARTY       VARCHAR,
    ELECTION_36_VOTE_METHOD VARCHAR,
    ELECTION_36_PARTY       VARCHAR,
    ELECTION_37_VOTE_METHOD VARCHAR,
    ELECTION_37_PARTY       VARCHAR,
    ELECTION_38_VOTE_METHOD VARCHAR,
    ELECTION_38_PARTY       VARCHAR,
    ELECTION_39_VOTE_METHOD VARCHAR,
    ELECTION_39_PARTY       VARCHAR,
    ELECTION_40_VOTE_METHOD VARCHAR,
    ELECTION_40_PARTY       VARCHAR,
    HOME_PHONE              VARCHAR,
    COUNTY                  VARCHAR,
    MAIL_COUNTRY            VARCHAR
);

create table IF NOT EXISTS RAW.PENNSYLVANIA_NCOA_RESULTS_2023_11_13
(
    INPUT_FILE_DATE                     VARCHAR,
    INPUT_COUNTY                        VARCHAR,
    INPUT_ID                            VARCHAR,
    INPUT_TITLE                         VARCHAR,
    INPUT_LAST_NAME                     VARCHAR,
    INPUT_FIRST_NAME                    VARCHAR,
    INPUT_MIDDLE_NAME                   VARCHAR,
    INPUT_SUFFIX                        VARCHAR,
    INPUT_ADDRESS_LINE_1                VARCHAR,
    INPUT_ADDRESS_LINE_2                VARCHAR,
    INPUT_ADDRESS_CITY                  VARCHAR,
    INPUT_ADDRESS_STATE                 VARCHAR,
    INPUT_ADDRESS_ZIP                   VARCHAR,
    HOUSEHOLD_POSITION                  VARCHAR,
    NAME_ID                             VARCHAR,
    INDIVIDUAL_RECORD_ID                VARCHAR,
    FIRST_NAME                          VARCHAR,
    LAST_NAME                           VARCHAR,
    COMPANY_NAME                        VARCHAR,
    STREET_NUMBER                       VARCHAR,
    STREET_PRE_DIRECTION                VARCHAR,
    STREET_NAME                         VARCHAR,
    STREET_POST_DIRECTION               VARCHAR,
    STREET_SUFFIX                       VARCHAR,
    UNIT_TYPE                           VARCHAR,
    UNIT_NUMBER                         VARCHAR,
    BOX_NUMBER                          VARCHAR,
    CITY_NAME                           VARCHAR,
    STATE_CODE                          VARCHAR,
    POSTAL_CODE                         VARCHAR,
    POSTAL_CODE_EXTENSION               VARCHAR,
    CARRIER_ROUTE                       VARCHAR,
    ADDRESS_STATUS                      VARCHAR,
    ERROR_NUMBER                        VARCHAR,
    ADDRESS_TYPE                        VARCHAR,
    DELIVERY_POINT                      VARCHAR,
    CHECK_DIGIT                         VARCHAR,
    DELIVERY_POINT_VERIFICATION         VARCHAR,
    DELIVERY_POINT_VERIFICATION_NOTES   VARCHAR,
    VACANT                              VARCHAR,
    CONGRESSIONAL_DISTRICT_CODE         VARCHAR,
    AREA_CODE                           VARCHAR,
    LATITUDE                            VARCHAR,
    LONGITUDE                           VARCHAR,
    TIME_ZONE                           VARCHAR,
    COUNTY_NAME                         VARCHAR,
    COUNTY_FIPS                         VARCHAR,
    STATE_FIPS                          VARCHAR,
    BARCODE                             VARCHAR,
    LOCATABLE_ADDRESS_CONVERSION_SYSTEM VARCHAR,
    LINE_OF_TRAVEL                      VARCHAR,
    ASCENDING_OR_DESCENDING             VARCHAR,
    MOVE_APPLIED                        VARCHAR,
    MOVE_TYPE                           VARCHAR,
    MOVE_DATE                           VARCHAR,
    MOVE_DISTANCE                       VARCHAR,
    MATCH_FLAG                          VARCHAR,
    NXI                                 VARCHAR,
    ANK                                 VARCHAR,
    RESIDENTIAL_DELIVERY_INDICATOR      VARCHAR,
    RECORD_TYPE                         VARCHAR,
    COUNTRY_CODE                        VARCHAR,
    ADDRESS_LINE_1                      VARCHAR,
    ADDRESS_LINE_2                      VARCHAR,
    ADDRESS_ID                          VARCHAR,
    HOUSEHOLD_ID                        VARCHAR,
    INDIVIDUAL_ID                       VARCHAR
);

create table IF NOT EXISTS RAW.PENNSLYVANIA_VOTER_HISTORY_2023_11_13
(
    VOTER_ID             VARCHAR,
    ELECTION_DATE        VARCHAR,
    ELECTION_DESCRIPTION VARCHAR,
    VOTE_METHOD          VARCHAR,
    VOTE_PARTY           VARCHAR
);

COPY INTO RAW.PENNSYLVANIA_VOTERS_2023_11_13
    FROM @VOTER_FILES/pennsylvania/raw_data/file_date=2023_11_13/voter_export/
    FILE_FORMAT = (
    TYPE = 'CSV', FIELD_OPTIONALLY_ENCLOSED_BY = '"', FIELD_DELIMITER = '\t',
    SKIP_HEADER = 0, ESCAPE_UNENCLOSED_FIELD = NONE, TRIM_SPACE = TRUE,
    EMPTY_FIELD_AS_NULL = TRUE, NULL_IF = ( 'NULL', '')
    )
    ON_ERROR = 'CONTINUE';

COPY INTO RAW.PENNSYLVANIA_NCOA_RESULTS_2023_11_13
    FROM @VOTER_FILES/pennsylvania/ncoa_data/file_date=2023_11_13/
    FILE_FORMAT = (
    TYPE = 'CSV', FIELD_OPTIONALLY_ENCLOSED_BY = '"', FIELD_DELIMITER = ',',
    SKIP_HEADER = 1, ESCAPE_UNENCLOSED_FIELD = NONE, TRIM_SPACE = TRUE,
    EMPTY_FIELD_AS_NULL = TRUE, NULL_IF = ( 'NULL', '')
    )
    ON_ERROR = 'ABORT_STATEMENT';

COPY INTO RAW.PENNSLYVANIA_VOTER_HISTORY_2023_11_13
    FROM @VOTER_FILES/pennsylvania/voter_history/file_date=2023_11_13/
    FILE_FORMAT = (
    TYPE = 'CSV', FIELD_OPTIONALLY_ENCLOSED_BY = '"', FIELD_DELIMITER = ',',
    SKIP_HEADER = 0, ESCAPE_UNENCLOSED_FIELD = NONE, TRIM_SPACE = TRUE,
    EMPTY_FIELD_AS_NULL = TRUE, NULL_IF = ( 'NULL', '')
    )
    ON_ERROR = 'CONTINUE'

{% endmacro %}