with __dbt__cte__ohio_counties as (



SELECT *
FROM (VALUES (1, 'Adams'),
             (2, 'Allen'),
             (3, 'Ashland'),
             (4, 'Ashtabula'),
             (5, 'Athens'),
             (6, 'Auglaize'),
             (7, 'Belmont'),
             (8, 'Brown'),
             (9, 'Butler'),
             (10, 'Carroll'),
             (11, 'Champaign'),
             (12, 'Clark'),
             (13, 'Clermont'),
             (14, 'Clinton'),
             (15, 'Columbiana'),
             (16, 'Coshocton'),
             (17, 'Crawford'),
             (18, 'Cuyahoga'),
             (19, 'Darke'),
             (20, 'Defiance'),
             (21, 'Delaware'),
             (22, 'Erie'),
             (23, 'Fairfield'),
             (24, 'Fayette'),
             (25, 'Franklin'),
             (26, 'Fulton'),
             (27, 'Gallia'),
             (28, 'Geauga'),
             (29, 'Greene'),
             (30, 'Guernsey'),
             (31, 'Hamilton'),
             (32, 'Hancock'),
             (33, 'Hardin'),
             (34, 'Harrison'),
             (35, 'Henry'),
             (36, 'Highland'),
             (37, 'Hocking'),
             (38, 'Holmes'),
             (39, 'Huron'),
             (40, 'Jackson'),
             (41, 'Jefferson'),
             (42, 'Knox'),
             (43, 'Lake'),
             (44, 'Lawrence'),
             (45, 'Licking'),
             (46, 'Logan'),
             (47, 'Lorain'),
             (48, 'Lucas'),
             (49, 'Madison'),
             (50, 'Mahoning'),
             (51, 'Marion'),
             (52, 'Medina'),
             (53, 'Meigs'),
             (54, 'Mercer'),
             (55, 'Miami'),
             (56, 'Monroe'),
             (57, 'Montgomery'),
             (58, 'Morgan'),
             (59, 'Morrow'),
             (60, 'Muskingum'),
             (61, 'Noble'),
             (62, 'Ottawa'),
             (63, 'Paulding'),
             (64, 'Perry'),
             (65, 'Pickaway'),
             (66, 'Pike'),
             (67, 'Portage'),
             (68, 'Preble'),
             (69, 'Putnam'),
             (70, 'Richland'),
             (71, 'Ross'),
             (72, 'Sandusky'),
             (73, 'Scioto'),
             (74, 'Seneca'),
             (75, 'Shelby'),
             (76, 'Stark'),
             (77, 'Summit'),
             (78, 'Trumbull'),
             (79, 'Tuscarawas'),
             (80, 'Union'),
             (81, 'Van Wert'),
             (82, 'Vinton'),
             (83, 'Warren'),
             (84, 'Washington'),
             (85, 'Wayne'),
             (86, 'Williams'),
             (87, 'Wood'),
             (88, 'Wyandot')) AS A (county_id, county_name)
) SELECT '2023-09-25'::date                               as FILE_DATE,
       'OH'                                             as STATE_CODE,
       COUNTY.county_name                               as COUNTY_CODE,
       VOTERS.SOS_VOTERID                               AS VOTER_ID,
       NULL                                             AS PREFIX,
       VOTERS.FIRST_NAME                                AS FIRST_NAME,
       VOTERS.MIDDLE_NAME                               AS MIDDLE_NAME,
       VOTERS.LAST_NAME                                 AS LAST_NAME,
       VOTERS.SUFFIX                                    AS NAME_SUFFIX,
       RESIDENTIAL_ADDRESS1                             AS RESIDENCE_ADDRESS_LINE_1,
       RESIDENTIAL_SECONDARY_ADDR                       AS RESIDENCE_ADDRESS_LINE_2,
       RESIDENTIAL_CITY                                 AS RESIDENCE_ADDRESS_CITY,
       COALESCE(RESIDENTIAL_STATE, 'OH')                AS RESIDENCE_ADDRESS_STATE,
       RESIDENTIAL_ZIP                                  AS RESIDENCE_ADDRESS_ZIPCODE,
       COALESCE(RESIDENTIAL_COUNTRY, 'USA')             AS RESIDENCE_ADDRESS_COUNTRY,
       YEAR(TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD'))       AS BIRTH_YEAR,
       MONTH(TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD'))      AS BIRTH_MONTH,
       DAYOFMONTH(TO_DATE(DATE_OF_BIRTH, 'YYYY-MM-DD')) AS BIRTH_DATE,
       CASE
           WHEN VOTER_STATUS = 'ACTIVE' THEN 'A'
           WHEN VOTER_STATUS = 'CONFIRMATION' THEN 'CON'
           ELSE NULL
           END                                          as VOTER_STATUS,
       TO_DATE(REGISTRATION_DATE, 'YYYY-MM-DD')         AS REGISTRATION_DATE,
       NULL                                             AS LAST_VOTED_DATE,
       PARTY_AFFILIATION                                AS LAST_PARTY_VOTED,
       CONGRESSIONAL_DISTRICT                           AS CONGRESSIONAL_DISTRICT,
       STATE_SENATE_DISTRICT                            AS STATE_SENATE_DISTRICT,
       STATE_REPRESENTATIVE_DISTRICT                    AS STATE_HOUSE_DISTRICT,
       NULL                                             AS JUDICIAL_DISTRICT,
       NULL                                             AS COUNTY_COMMISSION_DISTRICT,
       CITY_SCHOOL_DISTRICT                             AS SCHOOL_BOARD_DISTRICT,
       NULL                                             AS CITY_COUNCIL_DISTRICT,
       PRECINCT_NAME                                    AS COUNTY_PRECINCT,
       NULL                                             AS MUNICIPAL_PRECINCT,
       NULL                                             AS RACE,
       NULL                                             AS GENDER,
       MAILING_ADDRESS1                                 AS MAILING_ADDRESS_LINE_1,
       MAILING_SECONDARY_ADDRESS                        AS MAILING_ADDRESS_LINE_2,
       NULL                                             AS MAILING_LINE_3,
       MAILING_CITY                                     AS MAILING_CITY,
       MAILING_STATE                                    AS MAILING_STATE,
       MAILING_ZIP                                      AS MAILING_ZIPCODE,
       MAILING_COUNTRY                                  AS MAILING_COUNTRY
FROM DBT_VOTER_DATA.raw.OHIO_VOTERS_2023_09_25 VOTERS
         INNER JOIN __dbt__cte__ohio_counties COUNTY ON VOTERS.COUNTY_NUMBER = COUNTY.county_id